<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Store Chatbot</title>
  <style>
    body{font-family:system-ui, Arial; margin:0; background:#f6f6f6}
    .wrap{max-width:900px; margin:0 auto; padding:16px}
    .card{background:#fff; border-radius:14px; padding:16px; box-shadow:0 6px 18px rgba(0,0,0,.06)}
    .title{font-size:20px; margin:0 0 10px}
    #chat{height:55vh; overflow:auto; border:1px solid #eee; border-radius:12px; padding:12px; background:#fafafa}
    .msg{margin:10px 0; line-height:1.6}
    .you{color:#111}
    .bot{color:#0b5}
    .meta{font-size:12px; color:#888}
    .row{display:flex; gap:10px; margin-top:12px}
    input{flex:1; padding:12px; border-radius:12px; border:1px solid #ddd; font-size:16px}
    button{padding:12px 16px; border-radius:12px; border:0; background:#111; color:#fff; cursor:pointer}
    button:disabled{opacity:.6; cursor:not-allowed}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1 class="title">ğŸ’¬ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ â€” Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</h1>
      <div class="meta">Ø§Ù„Ù…ØµØ¯Ø±: Ù…Ù„Ù Ø§Ù„Ù…ØªØ¬Ø± (RAG) + Ø°Ø§ÙƒØ±Ø© Ù„ÙƒÙ„ Ø¬Ù„Ø³Ø©</div>
      <div id="chat"></div>

      <div class="row">
        <input id="msg" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." autocomplete="off" />
        <button id="send">Ø¥Ø±Ø³Ø§Ù„</button>
      </div>
    </div>
  </div>

<script>
  // Session ID Ø«Ø§Ø¨Øª Ù„Ù„Ù…ØªØµÙØ­ (ÙƒÙ„ Ø¹Ù…ÙŠÙ„ Ù„Ù‡ Ø°Ø§ÙƒØ±Ø© Ù…Ø®ØªÙ„ÙØ©)
  const sessionId = localStorage.getItem("session_id") || crypto.randomUUID();
  localStorage.setItem("session_id", sessionId);

  const chat = document.getElementById("chat");
  const msg = document.getElementById("msg");
  const send = document.getElementById("send");

  function addMessage(text, who){
    const div = document.createElement("div");
    div.className = "msg " + (who === "you" ? "you" : "bot");
    div.textContent = (who === "you" ? "Ø£Ù†Øª: " : "Bot: ") + text;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
  }
  const API_URL = "https://ahmed-chatbot-production-b48c.up.railway.app";
  async function sendMessage(){
    const text = msg.value.trim();
    if(!text) return;

    addMessage(text, "you");
    msg.value = "";
    send.disabled = true;

    try{
      const res = await fetch("/chat", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ session_id: sessionId, message: text })
      });
      const data = await res.json();
      addMessage(data.reply || "Ø­ØµÙ„ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.", "bot");
    }catch(e){
      addMessage("ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±. ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± Ø´ØºØ§Ù„.", "bot");
    }finally{
      send.disabled = false;
      msg.focus();
    }
  }

  send.addEventListener("click", sendMessage);
  msg.addEventListener("keydown", (e)=>{ if(e.key === "Enter") sendMessage(); });

  addMessage("Ø£Ù‡Ù„Ù‹Ø§! Ø§Ø³Ø£Ù„Ù†ÙŠ Ø¹Ù† Ø§Ù„Ø£Ø³Ø¹Ø§Ø±/Ø§Ù„Ø´Ø­Ù†/Ø§Ù„Ø¯ÙØ¹/Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹.", "bot");
</script>
</body>
</html>
